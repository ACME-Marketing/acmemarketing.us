---
// @ts-nocheck
// This is an Astro file. Ignore linter errors about 'class' vs 'className'.
import BaseLayout from '../layouts/BaseLayout.astro'
import Hero from '../components/Hero.astro'
import HomepagePosts from '../components/HomepagePosts.astro'
import { graphQLClient, gql } from '../lib/graphql'
import { getCta } from '../lib/loadCtaData.js'

// GraphQL query for posts with tags "acmemarketing" or "all"
const GET_POSTS = gql`
  query GetPosts {
    posts(where: { tagSlugIn: ["acmemarketing", "all"] }) {
      nodes {
        title
        uri
        content
        featuredImage {
          node {
            sourceUrl
            altText
            mediaDetails {
              width
              height
            }
          }
        }
        tags {
          nodes {
            name
            slug
          }
        }
      }
    }
  }
`

let posts = []
try {
  const data = await graphQLClient.request(GET_POSTS)
  posts = data.posts.nodes
  console.log("Fetched posts for acmemarketing.us:", posts)
} catch (error) {
  console.error("Error fetching posts:", error)
}

const heroCta = getCta({ page: 'home', location: 'hero' })
const sidebarCta = getCta({ page: 'home', location: 'sidebar' })
const bottomCta = getCta({ page: 'home', location: 'bottom' })
---

<BaseLayout title="ACME Marketing">
  <Hero />
  <HomepagePosts posts={posts} />
  <!-- Example usage for Hero CTA -->
  <a href="#" class="cta-btn" data-cta="hero" data-ebook={heroCta['TITLE']} data-description={heroCta['DESCRIPTION']}>
    {heroCta['BUTTON TEXT']}
  </a>
  <!-- Example usage for Sidebar CTA -->
  <a href="#" class="cta-btn" data-cta="sidebar" data-ebook={sidebarCta['TITLE']} data-description={sidebarCta['DESCRIPTION']}>
    {sidebarCta['BUTTON TEXT']}
  </a>
  <!-- Example usage for Bottom CTA -->
  <a href="#" class="cta-btn" data-cta="bottom" data-ebook={bottomCta['TITLE']} data-description={bottomCta['DESCRIPTION']}>
    {bottomCta['BUTTON TEXT']}
  </a>
</BaseLayout>
